# Тестовое задание на позицию стажера Avito
___
В этом репозитории находится реализация [тестового задания](https://github.com/avito-tech/backend-trainee-assignment-2023) на позицию стажёра-бэкендера в Avito.

###### Выполнено ######
+ Основное задание
+ Доп. задание №1
+ Доп. задание №2
+ Доп. задание №3
+ Написаны тесты
+ Человеко-читабельные описания ошибок API
+ Документация Swagger
+ Докеризация

### Запуск
___

Для запуска требуется выполнить следующие шаги:

1. Скачать исходный код и перейти в директорию с проектом:
```linux
git clone https://github.com/pollykon/avito_test_task.git
cd avito_test_task
```
2. Настроить переменные окружения. В корне проекта нужно создать .env файл следующего содержания:
```text
PG_HOST = <хост_который_будет_использовать_бд>
PG_PORT = <порт_который_будет_использовать_бд>
PG_USER = <имя_пользователя_которое_будет_использовать_бд>
PG_PASSWORD = <пароль_который_будет_использовать_бд>
PG_DATABASE_NAME = <имя_бд>

LOGS_CSV_DIRECTORY = <директория_в_которой_будут_храниться_сгенерированные_логи>
```
3. Создать папку для логов:
```text
mkdir <директория_в_которой_будут_храниться_сгенерированные_логи>
```
4. Для развертывания dev-среды:
    + Запустить контейнер с базой данных
   ```text
    docker-compose up
    ```
   + Запустить сервер
   ```
   go run ./cmd/main/
   ```
5. Для развертывания prod-среды:
    + Запустить контейнеры с базой данных и сервером
   ```
   docker-compose -f docker-compose.prod.yml up --build 
   ```
6. Создать таблицы в базе данных. SQL файл с созданием необходимых таблиц находится [тут](https://github.com/pollykon/avito_test_task/blob/main/migration.sql) 

### Детали реализации
___

Для обеспечения устойчивости данных о балансе пользователя использовались следующие подходы:

### Структура проекта
___
```
avito_test_task/     
├─ cmd/
│  ├─ service/
│  │  ├─ main.go
├─ internal/   
│  ├─ handlers/      слой сетевого взаимодействия
│  ├─ logger/        
│  ├─ repository/    слой взаимодействия с бд
│  ├─ service/       слой бизнес-логики
├─ logs_csv/         хранение логов
```